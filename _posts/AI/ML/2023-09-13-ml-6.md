---
title: "[ML] Style Transfer 논문 리뷰"
excerpt: "[ML] Style Transfer 논문 리뷰"
categories: [ML]
tags: [ML, Python]
toc: true
toc_sticky: true
---

📌 [논문 리뷰](https://audrb1999.tistory.com/5) <br>
📌 [논문 리뷰 2](https://inhopp.github.io/paper/Paper1/) <br>
📌 [논문 리뷰 3](https://bkshin.tistory.com/entry/%EC%BB%B4%ED%93%A8%ED%84%B0-%EB%B9%84%EC%A0%84-14-%EC%8A%A4%ED%83%80%EC%9D%BC-%EC%A0%84%EC%9D%B4Style-Transfer) <br>
📌 [유튜브 링크](https://www.youtube.com/watch?v=va3e2c4uKJk) <br>

## Style Transfer 요약

- 이전까지의 방식들은 low-level feature들만 사용이 가능, 이미지를 변형시켰을 때 결과 이미지에서 high-level feature들에는 변화가 없었다.
- CNN 필터를 사용하여 얻은 high-level feature들을 사용할 것이다.

## Style Transfer

- 스타일 전송을 위해서 pre-trained CNN 모델(VGG19) 사용
- 가중치를 업데이트 하는 것이 학습이 아니라 두 개의 이미지를 사용하여 한 개의 이미지를 업데이트 하는 것이 학습
- 업데이트를 진행할 때는 손실값이 작아지는 방향으로 이미지를 업데이트
- CNN의 가중치를 고정시키고 noise 이미지를 업데이트하는 방식 <br>

![그림](https://user-images.githubusercontent.com/96368476/153026588-622ca670-cb34-4f18-832e-e6dd5588da3f.jpg) <br>
이렇게 손실함수가 정의가 되고, 손실값이 작아지는 방향으로 이미지를 업데이트를 한다. -> 여기서 style image와 content image의 강도조절은 알파, 베타로 진행을 한다. <br>

논문의 핵심 내용 <br>

- 이미지의 style을 어떻게 정의할 것인가?
- content와 style을 어떻게 reconstruction 할 것인가?

## Content Reconstruction

content 이미지를 reconstruction하기 위해 content loss 함수를 정의한다. <br>
![이미지](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbOJUeB%2FbtsiOHaOvx9%2FaGiQi2tMuyDLMBWkOtlKE1%2Fimg.png) <br>
노이즈 이미지(x)가 CNN 네트워크를 거쳐 특정한 피처 맵이 됨 -> 콘텐츠 이미지도 CNN 네트워크를 거쳐 피처 맵이 됨 (❗입력 이미지만 다를 뿐이지 동일 네트워크 사용.) <br>

### Lcontent의 기호 보기

- l: 레이어의 인덱스
- i: 피처맵상 채널의 위치
- j: 벡터상 활성화 값의 위치 <br>
  예를 들어서 F_ij^l은 l번째 레이어의 i번째 채널의 j번째 활성화 값을 뜻한다. <br>
  노이즈 이미지와 콘텐츠 이미지 각가에 대하여 같은 레이터에서 같은 채널에서의 같은 활성화 값(F_ij^l - P_ij^l)이 content loss 함수가 된다. <br>
  이 활성화 값의 최소가 되는 값을 찾는다는 것은 결국 노이즈 이미지가 콘텐츠 이미지와 비슷해진다.

## Style Reconstruction

스타일은 서로 다른 특징들간의 상관관계로 정의를 한다. <br>
두 피처 간의 스타일이 비슷하다는 말은 상관관계가 높다는 뜻. 상관관계는 두 피처의 내적을 통해서 나타낼 수 있다. <br>
내적 값이 크면 두 피처의 패턴이 비슷하다는 뜻이고, 내적이 작으면 패턴이 다르다는 뜻이다. <br>

![이미지](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FNRe0V%2FbtsiOKd9qvx%2FifzWKsqIkYBdaU4pjdRJ01%2Fimg.png) <br>
