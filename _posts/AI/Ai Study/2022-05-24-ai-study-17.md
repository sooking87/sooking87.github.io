---
title: "[chap 7-3] ì‹ ê²½ë§ ëª¨ë¸ í›ˆë ¨"
excerpt: "[chap 7-3] ì‹ ê²½ë§ ëª¨ë¸ í›ˆë ¨"
categories: [Ai Study]
tags: [Ai Study, Python]
toc: true
toc_sticky: true
---

ë¨¸ì‹  ëŸ¬ë‹ì€ ê¸°ì¡´ì˜ ëª¨ë¸ì„ ì‚¬ìš©í•˜ë˜, êµ¬ì¡°ëŠ” ê³ ì •ë˜ì–´ìˆëŠ” ë°˜ë©´, ë”¥ëŸ¬ë‹ì˜ ê²½ìš° í•˜ì´í¼íŒŒë¼ë¯¸í„°ê°€ ë§ì•„ì„œ ì§ì ‘ ëª¨ë¸ì˜ êµ¬ì¡°ë¥¼ ì¡°ì •í•˜ë©´ì„œ ë§Œë“ ë‹¤ë¼ëŠ” ëŠë‚Œì´ ê°•í•˜ë‹¤.

## ğŸ”® ì†ì‹¤ ê³¡ì„ 

### ğŸ“ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°

```python
from tensorflow import keras
from sklearn.model_selection import train_test_split

(train_input, train_target), (test_input, test_target) = keras.datasets.fashion_mnist.load_data()
train_scaled = train_input / 255.0
train_scaled, val_scaled, train_target, val_target = train_test_split(train_scaled, train_target, test_size=0.2, random_state=42)
```

-> ëª¨ë¸ì„ ë§Œë“¤ì–´ì£¼ëŠ” í•¨ìˆ˜ ìƒì„±

```python
def model_fn(a_layer=None):
  model = keras.Sequential()
  model.add(keras.layers.Flatten(input_shape=(28, 28)))
  model.add(keras.layers.Dense(100, activation='relu'))
  if a_layer:
    model.add(a_layer)
  model.add(keras.layers.Dense(10, activation='softmax'))
  return model
```

### ğŸ“ ì†ì‹¤ í•¨ìˆ˜ ê·¸ë¦¬ê¸°

fit() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ History í´ë˜ìŠ¤ ê°ì²´ë¥¼ ë°˜í™˜ -> ì—¬ê¸°ì—ëŠ” í›ˆë ¨ ê³¼ì •ì—ì„œ ê³„ì‚°í•œ ì†ì‹¤ê³¼ ì •í™•ë„ ê°’ì´ ì €ì¥ë˜ì–´ ìˆë‹¤.

```python
model = model_fn()
model.compile(loss='sparse_categorical_crossentropy', metrics='accuracy')
history = model.fit(train_scaled, train_target, epochs=5, verbose=0)
print(history.history.keys())

>>> dict_keys(['loss', 'accuracy'])
```

hitstoryë¼ëŠ” ê°ì²´ì˜ history ë”•ì…”ë„ˆë¦¬ê°€ ìˆëŠ”ë° ì—¬ê¸°ì˜ key ê°’ì€ ì†ì‹¤ê³¼ ì •í™•ë„ê°€ ìˆë‹¤.

1. epoch = 5

   ```python
   import matplotlib.pyplot as plt
   plt.plot(history.history['loss'])
   plt.xlabel('epoch')
   plt.ylabel('loss')
   plt.show()
   ```

   ![download1](https://user-images.githubusercontent.com/96654391/169883470-ccbdb8dc-ebb5-4e27-83db-fbd8c70fb05a.png)

   ```python
   plt.plot(history.history['accuracy'])
    plt.xlabel('epoch')
    plt.ylabel('accuracy')
    plt.show()
   ```

   ![download2](https://user-images.githubusercontent.com/96654391/169883478-6a4e3c61-3ee5-4120-b48a-61737b4d0aed.png)

2. epoch = 20

   ```python
   model = model_fn()
   model.compile(loss='sparse_categorical_crossentropy', metrics='accuracy')
   history = model.fit(train_scaled, train_target, epochs=20, verbose=0)
   plt.plot(history.history['loss'])
   plt.xlabel('epoch')
   plt.ylabel('loss')
   plt.show()
   ```

   ![download1](https://user-images.githubusercontent.com/96654391/169883717-28272b28-a117-4c83-acc8-350120e69d38.png)

   ```python
    plt.plot(history.history['accuracy'])
    plt.xlabel('epoch')
    plt.ylabel('accuracy')
    plt.show()
   ```

   ![download2](https://user-images.githubusercontent.com/96654391/169883723-ed3f12b2-5a21-4d27-b7ed-2ee6f9a281bf.png)

## ğŸ”® ê²€ì¦ ì†ì‹¤

ê³¼ëŒ€ ì í•©, ê³¼ì†Œ ì í•©ì„ ì•Œê¸° ìœ„í•´ì„œëŠ” í›ˆë ¨ ì„¸íŠ¸ì˜ ì†ì‹¤ + ê²€ì¦ ì„¸íŠ¸ì˜ ì†ì‹¤ê¹Œì§€ ê·¸ë ¤ì•¼ ëœë‹¤.

```python
model = model_fn()
model.compile(loss='sparse_categorical_crossentropy', metrics='accuracy')
history = model.fit(train_scaled, train_target, epochs=20, verbose=0, validation_data=(val_scaled, val_target))
```

ì´ëŸ°ì‹ìœ¼ë¡œ fit() ë©”ì†Œë“œì—ì„œ validation_data ë§¤ê°œë³€ìˆ˜ì— ê²€ì¦ì— ì‚¬ìš©í•  ì…ë ¥ê³¼ íƒ€ê¹ƒê°’ì„ íŠœí”Œë¡œ ì „ë‹¬í•´ì£¼ë©´ history ê°ì²´ì˜ key ê°’ìœ¼ë¡œ ì¶”ê°€ê°€ ëœë‹¤.

1. ê¸°ë³¸ RMSprop ì˜µí‹°ë§ˆì´ì € ì‚¬ìš©

   ```python
   plt.plot(history.history['loss'])
   plt.plot(history.history['val_loss'])
   plt.xlabel('epoch')
   plt.ylabel('loss')
   plt.legend(['train', 'val'])
   plt.show()
   ```

   ![download1](https://user-images.githubusercontent.com/96654391/169884143-084cc5b8-944b-4ba8-add5-643ffdb6e0db.png)

2. adam ì‚¬ìš©

   ```python
   model = model_fn()
   model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics='accuracy')
   history = model.fit(train_scaled, train_target, epochs=20, verbose=0, validation_data=(val_scaled, val_target))
   ```

   ![download2](https://user-images.githubusercontent.com/96654391/169884264-a476a133-2f7a-4c4c-9445-9a94c9f81372.png)

<br>

ê³¼ëŒ€ ì í•©ì„ ë§‰ê¸° ìœ„í•´ì„œëŠ” ì˜µí‹°ë§ˆì´ì €ë¥¼ ìˆ˜ì •í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.

## ğŸ”® ë“œë¡­ ì•„ì›ƒ

í›ˆë ¨ ê³¼ì •ì—ì„œ ì¸µì— ìˆëŠ” ì¼ë¶€ ë‰´ëŸ°ì„ ëœë¤í•˜ê²Œ êº¼ì„œ ê³¼ëŒ€ì í•©ì„ ë§‰ëŠ”ë‹¤. <br>

ì™œ ê³¼ëŒ€ì í•©ì„ ë§‰ì„ ìˆ˜ ìˆì„ê¹Œ? <br>

1. ì´ì „ ì¸µì˜ ì¼ë¶€ ë‰´ëŸ°ì´ ëœë¤í•˜ê²Œ êº¼ì§€ë©´ íŠ¹ì • ë‰´ëŸ°ì— ê³¼ëŒ€í•˜ê²Œ ì˜ì¡´í•˜ëŠ” ê²ƒì„ ì¤„ì¼ ìˆ˜ ìˆê³ , ëª¨ë“  ì…ë ¥ì— ì£¼ì˜ë¥¼ ê¸°ìš¸ì—¬ì•¼ í•œë‹¤.

2. 2ê°œì˜ ì‹ ê²½ë§ì„ ì•™ìƒë¸” í•˜ëŠ” ê²ƒ ì²˜ëŸ¼ ìƒìƒ ê°€ëŠ¥

```python
model = model_fn(keras.layers.Dropout(0.3))
```

-> 30% ì •ë„ ë“œë¡­ ì•„ì›ƒ

```python
model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics='accuracy')
history = model.fit(train_scaled, train_target, epochs=20, verbose=0, validation_data=(val_scaled, val_target))
plt.plot(history.history['loss'])
plt.plot(history.history['val_loss'])
plt.xlabel('epoch')
plt.ylabel('loss')
plt.legend(['train', 'val'])
plt.show()
```

![download1](https://user-images.githubusercontent.com/96654391/169884791-164ccd1c-9df6-40fe-8720-90d00ffc5a04.png) <br>

->ì–´ëŠ ì •ë„ ê³¼ëŒ€ ì í•© í•´ê²°ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ.
