---
title: "[week 3] CNN의 이해 (3)"
excerpt: "[week 3] CNN의 이해 (3)"
categories: [GDSC ML]
tags: [GDSC ML, Python]
toc: true
toc_sticky: true
---

## CNN

### A bit of history

### CNN

경계를 잘 분류한다. 그 이상의 구체적인 분류도 가능하다. 그 경계 상자만 찾는 것이 아니라 모든 픽셀에 대한 레이블을 지정할 수도 있다. <br>

얼굴 인식 가능, 포즈 인식 가능, 게임에서의 강화 학습에 사용된다. 의료 이미지의 해석 및 진단, 은하 분류, 거리 표지판 분류, 고래 인삭(Kaggle Challenage), 거리 분류, 사진을 찍고 특정 화가의 이미지로 다시 이미지화(Redraw)에도 사용된다.

<img width="616" alt="download1" src="https://user-images.githubusercontent.com/96654391/196013892-2900e1b9-c83f-4c25-8ce4-f1c31841c3c6.png">

## How CNN Works

### Fully Connected Layer

<img width="621" alt="download2" src="https://user-images.githubusercontent.com/96654391/196013893-d81f00f2-eb16-4eda-b793-139d1c9c9220.png"> <br>

만약에 32 \* 32 \* 3 이미지가 들어왔을 때, 이를 3072차원의 벡터로 변경시킨다.이미지들의 픽셀들을 다 일렬로 나열시킨다고 볼 수 있을듯? 강의에서는 strectch to 3072 \* 1이라고 표현. 그렇게 된다면 1 \* (32 \* 32 \* 3)의 값이 될 것이다. 3072차원의 벡터로 변경시킨다. <br>

-> 10개의 가중치가 있다고 한다면 input(1 \* 3072) \* Weight(3072 \* 10) (내적 곱을 통해서 구함) <br>

-> activation(output of this layers)(1 \* 10) 뉴런 output은 10개를 가지게 될 것이다. <br>

### Convolution Layer

Fully Connected Layer와의 차이점은 Fully Connected 의 경우 3차원으로 입력을 받아도 결국 하나의 긴 벡터로 펼친 후에 사용을 했는데, Convolution의 경우는 3차원 입력값을 그대로 사용한다.

<img width="616" alt="download1" src="https://user-images.githubusercontent.com/96654391/196018454-580dd987-0892-47aa-b299-338b9c8a45fa.png">

필터의 너비와 높이의 크기는 입력보다 작을지라도 높이는 동일해야됩니다. 이 필터는 가중치가 된다. <br>

<img width="613" alt="download2" src="https://user-images.githubusercontent.com/96654391/196018456-fe66b36f-f05a-4de7-8e9d-783ead79fb35.png">

이 필터를 가지고 처음부터 stride만큼 이동을 하면서 이미지의 공간 위치 위에 오버레이를 한 다음 내적을 계산한다. 필터와 이미지의 작은 5\*5\*3의 작은 청크 사이의 내적 곱이 필터와 이미지 청크를 펼쳐서 계산한 값과 같다.

<img width="616" alt="download1" src="https://user-images.githubusercontent.com/96654391/196019013-60cbb975-7ba0-4f3b-9494-22a006a142de.png">

이렇게 계산된 하나의 값이 있는데, 필터를 한 칸씩 이동을 하면서 해당 이미지 청크와 합성곱을 구하고, 이렇게 해서 activation map이 생기게 된다.

<img width="613" alt="download2" src="https://user-images.githubusercontent.com/96654391/196019018-4b240f9b-7f44-4395-859b-823d2fd5aba4.png">

<img width="1000" alt="download1" src="https://user-images.githubusercontent.com/96654391/196019102-a6f136c4-43b4-4c82-8ed7-84fa74a903c2.png">

필터를 다르게 해서(색깔이 다른 것을 통해서 확인할 수 있다.) 여러 개의 activation maps가 생긴것을 확인할 수 있다. <br>

결론적으로 28 _ 28 _ 6인 새로운 이미지를 쌓은 것을 확인할 수 있다.
