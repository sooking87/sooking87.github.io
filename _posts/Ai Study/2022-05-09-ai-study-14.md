---
title: "[chap 6-3] ì£¼ì„±ë¶„ ë¶„ì„"
excerpt: "[chap 6-3] ì£¼ì„±ë¶„ ë¶„ì„"
categories: [Ai Study]
tags: [Ai Study, Python]
toc: true
toc_sticky: true
---

### â“ ì‚¬ì§„ ìš©ëŸ‰ ì°¨ì§€ ë§ì•„ -> ì••ì¶•í•˜ëŠ” ë°©ë²• â“

### ğŸ’¡ í•´ê²°ì±… ğŸ’¡

ì°¨ì› ì¶•ì†Œ <br>
ì°¨ì› ì¶•ì†Œë¥¼ í†µí•´ì„œ ë°ì´í„°ë¥¼ ê°€ì¥ ì˜ ë‚˜íƒ€ë‚´ëŠ” ì¼ë¶€ íŠ¹ì„±ì„ ì„ íƒ, ë°ì´í„° í¬ê¸°ë¥¼ ì¤„ì—¬ -> ê³¼ëŒ€ì í•©ì„ ë§‰ì„ ìˆ˜ ìˆìŒ = ì§€ë„ í•™ìŠµ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤. <br>

ì†ì‹¤ì„ ìµœì†Œí™”í•˜ë©´ì„œ ë³µì› ê°€ëŠ¥

## ğŸ”® ì£¼ì„±ë¶„ ë¶„ì„

ë°ì´í„°ì— ìˆëŠ” ë¶„ì‚°ì´ í° ë°©í–¥ì„ ì°¾ëŠ” ê²ƒ. ë¶„ì‚°ì´ í° ë°©í–¥ = ë°ì´í„°ë¥¼ ì˜ í‘œí˜„í•˜ëŠ” ì–´ë–¤ ë²¡í„° = ì£¼ì„±ë¶„ ì´ë¼ê³  ë¶€ë¥¸ë‹¤. <br>
ì¦‰, ì£¼ì„±ë¶„ ë²¡í„°ëŠ” ë°ì´í„°ê°€ ì–´ë–¤ ë°©í–¥ì„ ê°€ë¦¬í‚¤ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤. ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì£¼ì„±ë¶„ ë²¡í„°ì— ì§ê°ìœ¼ë¡œ íˆ¬ì˜ -> ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì£¼ì„±ë¶„ ë²¡í„°ë¡œ ë§Œë“¬.

- ì£¼ì„±ë¶„ì€ ì›ë³¸ ì°¨ì›ê³¼ ê°™ê³ , ì£¼ì„±ë¶„ìœ¼ë¡œ ë°”ê¾¼ ë°ì´í„°ëŠ” ì°¨ì›ì´ ì¤„ì–´ë“ ë‹¤. ì›ë³¸ ë°ì´í„°ë¥¼ ì£¼ì„±ë¶„ ë²¡í„°ì— íˆ¬ì˜ì‹œì¼°ìœ¼ë‹ˆê¹Œ,,

### 1ï¸âƒ£ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°

```python
!wget https://bit.ly/fruits_300_data -O fruits_300.npy
import numpy as np
fruits = np.load('fruits_300.npy')
fruits_2d = fruits.reshape(-1, 100*100)
```

### 2ï¸âƒ£ PCA í´ë˜ìŠ¤

PCA í´ë˜ìŠ¤ë¡œ ì£¼ì„±ë¶„ ë¶„ì„ ì•Œê³ ë¦¬ì¦˜ì„ ì œê³µí•œë‹¤.

#### ğŸ“ ì°¨ì› ì¶•ì†Œ -> by n_components

```python
from sklearn.decomposition import PCA
pca = PCA(n_components=50)
pca.fit(fruits_2d)
print(fruits_2d.shape) # (300, 10000)
print(pca.components_.shape) # (50, 10000)
```

- n_components : ì£¼ì„±ë¶„ì˜ ê°œìˆ˜
- pca.components\_ : PCA í´ë˜ìŠ¤ê°€ ì°¾ì€ ì£¼ì„±ë¶„ì´ ì €ì¥ë˜ì–´ ìˆëŠ” ì†ì„±
  <br>

-> 300ê°œì˜ ì£¼ì„±ë¶„ì—ì„œ 50ê°œì˜ ì£¼ì„±ë¶„ì„ ì°¾ìŒ

```python
fruits_pca = pca.transform(fruits_2d)
print(fruits_pca.shape) # (300, 50)
```

ì°¾ì€ ì£¼ì„±ë¶„ì„ ê°€ì§€ê³  10000ê°œì˜ íŠ¹ì„±ì„ 50ê°œë¡œ ì¤„ì¼ ìˆ˜ ìˆë‹¤. -> transform() ë©”ì†Œë“œ ì‚¬ìš©
<br>

-> ê·¸ë˜ì„œ ì£¼ì„±ë¶„ì€ 300ê°œë¡œ ë™ì¼í•œë°, íŠ¹ì„± ê°œìˆ˜ê°€ 50ê°œë¡œ ì¤€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

#### ğŸ“ ì›ë³¸ ë°ì´í„° ì¬êµ¬ì„±

ìœ„ì—ì„œ íŠ¹ì„± ê°œìˆ˜ë¥¼ ì¤„ì˜€ê¸° ë•Œë¬¸ì— ì •ë³´ ì†ì‹¤ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ë¶„ì‚°ì´ í° ë°©í–¥ìœ¼ë¡œ ë°ì´í„°ë¥¼ íˆ¬ì˜í–ˆìœ¼ë‹ˆê¹Œ ë°ì´í„°ë¥¼ ì¬êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.

```python
fruits_inverse = pca.inverse_transform(fruits_pca)
print(fruits_inverse.shape)
```

- inverse_transform() ë©”ì†Œë“œ ì‚¬ìš© <br>

ì´ ë³µì›í•œ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ë°ì´í„°ë¥¼ ì¶œë ¥í•´ë³´ë©´

```python
fruits_reconstruct = fruits_inverse.reshape(-1, 100, 100)
for start in [0, 100, 200]:
  draw_fruits(fruits_reconstruct[start: start + 100])
  print("\n")
```

![download1](https://user-images.githubusercontent.com/96654391/167590935-1534965b-d4cf-46c2-9a07-dd164b16d94f.png)

<br>

![download2](https://user-images.githubusercontent.com/96654391/167590941-45b14f58-915c-476a-ad4e-d9e2c78ab052.png)

<br>

![download3](https://user-images.githubusercontent.com/96654391/167590947-053f7485-d0ad-4681-af7d-a65e660adcbb.png)

<br>
ì™€ ê°™ì´ ë‚˜ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ê¸°ì¡´ ë°ì´í„°ë³´ë‹¤ëŠ” ì¡°ê¸ˆ íë¦¬ì§€ë§Œ ê·¸ë˜ë„ ì´ì •ë„ë©´ ã„±ã…Š!

#### ğŸ“ ì„¤ëª…ëœ ë¶„ì‚°

ì£¼ì„±ë¶„ì´ ì›ë³¸ ë°ì´í„°ì˜ ë¶„ì‚°ì„ ì–¼ë§ˆë‚˜ ì˜ ë‚˜íƒ€ë‚´ëŠ”ì§€ ê¸°ë¡í•œ ê°’ì´ë‹¤. PCA í´ë˜ìŠ¤ì˜ explained_variance_ratio\_ ì— ê° ì£¼ì„±ë¶„ì˜ ì„¤ëª…ëœ ë¶„ì‚° ë¹„ìœ¨ì´ ê¸°ë¡ë˜ì–´ ìˆë‹¤.

```python
print(pca.explained_variance_ratio_)

>>>
[0.42357017 0.09941755 0.06577863 0.04031172 0.03416875 0.03281329
 0.02573267 0.02054963 0.01372276 0.01342773 0.01152146 0.00944596
 0.00878232 0.00846697 0.00693049 0.00645188 0.00578896 0.00511202
 0.00486382 0.00480346 0.00447834 0.00437315 0.00408031 0.00389464
 0.00372439 0.00359267 0.00331454 0.00317832 0.00304336 0.00303741
 0.00288869 0.0027589  0.00264685 0.00255902 0.00252099 0.00247324
 0.00239492 0.00230681 0.00221999 0.00216729 0.00213847 0.00196243
 0.00191376 0.00190319 0.0018515  0.00180475 0.00173677 0.00166861
 0.00159006 0.00158833]
```

- pca : 50ê°œì˜ ì£¼ì„±ë¶„ì„ ë§Œë“  PCA ê°ì²´
- ì¶œë ¥ê°’ : ê·¸ 50ê°œ ê°ê°ì˜ ì£¼ì„±ë¶„ì˜ ì„¤ëª…ëœ ë¶„ì‚° ë¹„ìœ¨

```python
print(np.sum(pca.explained_variance_ratio_)) #0.9214719451932281

plt.plot(pca.explained_variance_ratio_)
plt.show()
```

ë¶„ì‚°ì´ 92%ì •ë„ë¥¼ ìœ ì§€í•˜ê³  ìˆë‹¤ëŠ” ë§ì€ 300ê°œì˜€ë˜ ì£¼ì„±ë¶„ì„ 50ê°œë¡œ ì¤„ì˜€ëŠ”ë°ë„ ë¹„ìŠ·í•œ ë¶„ì‚°ì„ ê°€ì§€ê³  ìˆë‹¤ëŠ” ë§ì´ê³  ê·¸ë˜ì„œ ì•„ê¹Œ ë°ì´í„°ë¥¼ ë³µì›í•œ ê²ƒì´ ì›ë˜ì˜ ë°ì´í„°ì™€ ë¹„ìŠ·í•˜ê²Œ ë‚˜ì˜¨ ê²ƒì´ë‹¤. <br>

![download1](https://user-images.githubusercontent.com/96654391/167593061-d4aed49e-e6a6-4fee-bbd3-7c565a842f00.png) <br>

ì´ ê·¸ë˜í”„ì—ì„œ ë³´ë©´ ì²˜ìŒ ì£¼ì„±ë¶„ 10ê°œì •ë„ê°€ ëŒ€ë¶€ë¶„ì˜ ë¶„ì‚°ì„ í‘œí˜„í•˜ê³  ìˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. <br>

â“ ê·¸ëŸ¼ ì—¬ê¸°ì„œ íŠ¹ì„±ì„ ë” ì¤„ì´ë”ë¼ë„ ë¶„ì‚° ë¹„ìœ¨ì´ ì–´ëŠì •ë„ ë†’ê²Œ ë‚˜ì˜¨ë‹¤ë©´ ê·¸ê²Œ ë” ì´ë“ì¸ê±° ì•„ë‹Œê°€? -> ë¶„ì‚° ë¹„ìœ¨ì€ ì–´ëŠ ì •ë„ ìœ ì§€ê°€ ë˜ëŠ” ìµœì†Œì˜ íŠ¹ì„±ì€ ì–´ë–»ê²Œ êµ¬í• ê¹Œ?

### 3ï¸âƒ£ ë‹¤ë¥¸ ì•Œê³ ë¦¬ì¦˜ê³¼ í•¨ê»˜ ì‚¬ìš©í•˜ê¸°

PCA í´ë˜ìŠ¤ with ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ -> ì¶•ì†Œí•œ ë°ì´í„°ë¥¼ ì§€ë„ í•™ìŠµì— ì ìš©í•´ ë³´ê³  ì–´ë–¤ ì°¨ì´ê°€ ìˆëŠ”ì§€ ì•Œì•„ë³´ê¸°

1. íƒ€ê¹ƒ ë°ì´í„° ë§Œë“¤ê¸°

   ```python
   # íƒ€ê¹ƒ ë°ì´í„° ë§Œë“¤ê¸°
   from sklearn.linear_model import LogisticRegression

   lr = LogisticRegression()
   target =  np.array([0]*100 + [1]*100 + [2]*100)
   ```

   - íƒ€ê¹ƒ ë°ì´í„° : 0 -> íŒŒì¸ì• í”Œ, 1 -> ë°”ë‚˜ë‚˜, 2 -> ì‚¬ê³¼ (ì±…ê³¼ ì¡°ê¸ˆ ë‹¤ë¥´ê²Œ ë‚˜ì˜´,, ì™ ì§€ëŠ” ëª¨ë¥´ê² ë‹¤....)

2. fruit_2d êµì°¨ ê²€ì¦

   ````python # êµì°¨ ê²€ì¦ ê³¼ì •
   from sklearn.model_selection import cross_validate # êµì°¨ ê²€ì¦
   scores = cross_validate(lr, fruits_2d, target)
   print(np.mean(scores["test_score"]))
   print(np.mean(scores["fit_time"]))

    >>>
    0.9966666666666667
    2.0699679851531982
       ```
   ````

- test_score : êµì°¨ ê²€ì¦ì˜ ì ìˆ˜ í‰ê· 
- fit_time : êµì°¨ ê²€ì¦ í´ë“œì˜ í›ˆë ¨ ì‹œê°„ í‰ê· 

3. fruit_pca êµì°¨ ê²€ì¦

```python
scores = cross_validate(lr, fruits_pca, target)
print(np.mean(scores["test_score"]))
print(np.mean(scores["fit_time"]))

>>>
1.0
0.06742234230041504
```

ì°¨ì›ì„ ì¤„ì´ë”ë¼ë„ êµì°¨ ê²€ì¦ ì ìˆ˜ëŠ” ë¹„ìŠ·í•˜ì§€ë§Œ, í›ˆë ¨ ì‹œê°„ì´ í›¨ì”¬ ë§ì´ ì¤„ì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

4. +a : n_components -> ì„¤ëª…ëœ ë¶„ì‚° ë¹„ìœ¨ì„ ì…ë ¥í•  ìˆ˜ ìˆë‹¤.

```python
pca = PCA(n_components=0.5)
pca.fit(fruits_2d)
print(pca.n_components_)

>>> 2
```

ì£¼ì„±ë¶„ë“¤ ì¤‘ì—ì„œ ë¶„ì‚°ì˜ 50%ì— ë‹¬í•˜ëŠ” ì£¼ì„±ë¶„ì„ ì°¾ì•˜ì„ ë•Œ, ì£¼ì„±ë¶„ ê°œìˆ˜ê°€ 2ê°œì˜€ë‹¤. -> 2ê°œì˜ íŠ¹ì„±ì„ ê°€ì§€ê³  í›ˆë ¨ì„ ì‹œì¼œë„ 10000ê°œ, 50ê°œ íŠ¹ì„±ì„ ê°€ì§€ê³  í›ˆë ¨ ì‹œí‚¨ ê²ƒê³¼ ë¹„ìŠ·í•œ ê²°ê³¼ ë„ì¶œ ê°€ëŠ¥

```python
pca = PCA(n_components=0.5)
pca.fit(fruits_2d)
fruits_pca = pca.transform(fruits_2d)

scores = cross_validate(lr, fruits_pca, target)
print(np.mean(scores["test_score"]))
print(np.mean(scores["fit_time"]))

>>>
0.9933333333333334
0.04292616844177246
```

- ì •í™•ë„ 99%...2ê°œ ì‚¬ìš©í•˜ê³ ,,, ğŸ‘
- í›ˆë ¨ ê²°ê³¼ : ìµœì†Œ íŠ¹ì„± ê°œìˆ˜
- transform() : ì°¨ì› ì¶•ì†Œ
- êµì°¨ ê²€ì¦ : ì¶•ì†Œëœ ë°ì´í„°ë¥¼ ê°€ì§€ê³  êµì°¨ ê²€ì¦

5. 4ë²ˆ ê³¼ì •ì—ì„œì˜ ì°¨ì›ì´ ì¶•ì†Œëœ ë°ì´í„°ë¥¼ ê°€ì§€ê³  k-í‰ê·  ì•Œê³ ë¦¬ì¦˜ í™œìš©

```python
from sklearn.cluster import KMeans
km = KMeans(n_clusters=3, random_state=42)
km.fit(fruits_pca)

for label in range(0, 3):
  draw_fruits(fruits[km.labels_==label])
  print("\n")

```

- ì¶•ì†Œëœ ë°ì´í„°ë¡œ k-í‰ê·  ì•Œê³ ë¦¬ì¦˜ì„ í›ˆë ¨ì‹œì¼œì„œ ê° ë¼ë²¨ì— í•´ë‹¹í•˜ëŠ” ê³¼ì¼ ì¶œë ¥

![download1](https://user-images.githubusercontent.com/96654391/167607155-61d5d373-741f-4993-b993-b4bea148bbf2.png)
![download2](https://user-images.githubusercontent.com/96654391/167607163-983b0e9d-8d53-402f-b5af-3defdb73eb05.png)
![download3](https://user-images.githubusercontent.com/96654391/167607167-74c9c3aa-7646-44c0-a330-72947d4e0612.png) <br>

ì°¨ì›ì„ ì¤„ì´ë©´ í›ˆë ¨ ì‹œê°„ë„ ì ê²Œ ë“¤ ë¿ë§Œ ì•„ë‹ˆë¼ 3ê°œ ì´í•˜ë¡œ ì°¨ì›ì„ ì¤„ì´ë©´ í™”ë©´ì— ì¶œë ¥í•˜ê¸°ë„ ì‰½ë‹¤.

```python
for label in range(0, 3):
  data = fruits_pca[km.labels_==label]
  plt.scatter(data[:, 0], data[:, 1])
plt.legend(['pineapple', 'banana', 'apple'])
plt.show()
```

![download1](https://user-images.githubusercontent.com/96654391/167607509-02d79ce7-79ab-4e5e-8b88-5c84f7fc66a7.png)

- ì¶œë ¥ ê²°ê³¼ : í´ëŸ¬ìŠ¤í„°ë³„ë¡œ ë‚˜ëˆ„ì–´ ì‚°ì ë„ë¥¼ ê·¸ë¦¼ <br>

ê²°ë¡ ì ìœ¼ë¡œ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì„ ì‚¬ìš©í•´ì„œë„ ì„±ëŠ¥ í‰ê°€ ê°€ëŠ¥, ì°¨ì› ì¤„ì—¬ì„œ kMeansë¥¼ í†µí•´ì„œ ë°ì´í„° ì¶œë ¥ ê°€ëŠ¥, 3ì°¨ì› ì´í•˜ë©´ í™”ë©´ì— ì¶œë ¥í•˜ê¸° ì‰¬ì›€.
