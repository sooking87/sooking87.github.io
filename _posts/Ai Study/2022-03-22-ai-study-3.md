---
title: "[chap 2-2] ë°ì´í„° ì „ì²˜ë¦¬"
excerpt: "[chap 2-2] ë°ì´í„° ì „ì²˜ë¦¬"
categories: [Ai Study]
tags: [Ai Study, Python]
toc: true
toc_sticky: true
---

### â— ë¬¸ì œì  â—

ê¸¸ì´ê°€ 25, ë¬´ê²Œê°€ 150ì¸ ë„ë¯¸ë¥¼ ë¹™ì–´ë¼ê³  ì˜ˆì¸¡ì„ í•œë‹¤.

### ğŸ’¡ í•´ê²°ì±… ğŸ’¡

ë­ê°€ ë¬¸ì œì¸ì§€ ë¨¼ì € ì•Œì•„ë³¸ë‹¤.

## ğŸ“– ë¬¸ì œì  ë°œê²¬í•˜ê¸°

### 1ï¸âƒ£ ë„˜íŒŒì´ë¡œ ê°„ë‹¨í•˜ê²Œ ë°ì´í„° í˜•ì‹ ì²˜ë¦¬í•˜ê¸°

- ì• ì¥ì—ì„œ ë°˜ë³µë¬¸ê³¼ ë¦¬ìŠ¤íŠ¸ë¥¼ í†µí•´ì„œ fish_dataì™€ fish_targetì„ ë§Œë“¤ì—ˆë‹¤ë©´ ì´ì œë¶€í„°ëŠ” ë„˜íŒŒì´ë¥¼ í†µí•´ì„œ ë³´ë‹¤ ê°„ë‹¨í•˜ê²Œ ë°°ì—´ì„ ë§Œë“¤ ì˜ˆì •ì´ë‹¤.

```python
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
import numpy as np
import matplotlib.pyplot as plt

fish_length = [25.4, 26.3, 26.5, 29.0, 29.0, 29.7, 29.7, 30.0, 30.0, 30.7, 31.0, 31.0,
               31.5, 32.0, 32.0, 32.0, 33.0, 33.0, 33.5, 33.5, 34.0, 34.0, 34.5, 35.0,
               35.0, 35.0, 35.0, 36.0, 36.0, 37.0, 38.5, 38.5, 39.5, 41.0, 41.0, 9.8,
               10.5, 10.6, 11.0, 11.2, 11.3, 11.8, 11.8, 12.0, 12.2, 12.4, 13.0, 14.3, 15.0]
fish_weight = [242.0, 290.0, 340.0, 363.0, 430.0, 450.0, 500.0, 390.0, 450.0, 500.0, 475.0, 500.0,
               500.0, 340.0, 600.0, 600.0, 700.0, 700.0, 610.0, 650.0, 575.0, 685.0, 620.0, 680.0,
               700.0, 725.0, 720.0, 714.0, 850.0, 1000.0, 920.0, 955.0, 925.0, 975.0, 950.0, 6.7,
               7.5, 7.0, 9.7, 9.8, 8.7, 10.0, 9.9, 9.8, 12.2, 13.4, 12.2, 19.7, 19.9]


fish_data = np.column_stack((fish_length, fish_weight))
fish_target = np.concatenate((np.ones(35), np.zeros(14)))
train_input, test_input, train_target, test_target = train_test_split(
    fish_data, fish_target, stratify=fish_target, random_state=42)
```

- coulumn_stack : [[l, w] for l, w in zip(length, weight)]ê³¼ ê°™ì€ ì—­í• ì„ í•œë‹¤. í•˜ë‚˜ì”© ë½‘ì•„ì„œ ë§¤ì¹­, íŠœí”Œ ì‚¬ìš©!
- concatenate : [1] _ 35 + [0] _ 14ì™€ ê°™ì€ ì—­í• ì„ í•œë‹¤. ì—°ê²°
- train_test_split : ì•ì—ì„œ ì¸ë±ìŠ¤ë¥¼ ëœë¤ìœ¼ë¡œ ëŒë¦¬ê³  ì¸ë±ìŠ¤ì— í•´ë‹¹í•˜ëŠ” inputê³¼ targetì„ êµ¬í–ˆì—ˆëŠ”ë°, ì´ì™€ ê°™ì€ ì—­í• ì„ ëª¨ë‘ ì•Œì•„ì„œ!
  - stratify : í´ë˜ìŠ¤ ë¹„ìœ¨ì„ ë§ì¶°ì¤Œ(ë„ë¯¸ì™€ ë¹™ì–´ê°€ 3:1ì •ë„ë¡œ ë˜ê²Œë”)
  - random_state : seedì™€ ê°™ì€ ì—­í• 

### 2ï¸âƒ£ 25, 150ì§œë¦¬ ë„ë¯¸ê°€ ì™œ ë¹™ì–´ë¡œ ì˜ˆì¸¡í–ˆì„ê¹Œ?

- Kneighbors() : ì´ì›ƒê¹Œì§€ì˜ ê±°ë¦¬ì™€ ì´ì›ƒ ìƒ˜í”Œì˜ ì¸ë±ìŠ¤ë¥¼ ë°˜í™˜í•˜ëŠ” ë©”ì†Œë“œ

```python
distances, indexes = kn.kneighbors([[25, 150]])
```

ì¸ë±ìŠ¤ë¥¼ í”„ë¦°íŠ¸í•´ë³´ë©´ 1ê°œë§Œ ë„ë¯¸ë¡œ, ë‚˜ë¨¸ì§€ 4ê°œëŠ” ë¹™ì–´ë¡œ ì˜ˆì¸¡í•˜ì—¬ ë¹™ì–´ë¡œ ì˜ˆì¸¡í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.

- â“ ì™œ ì´ëŸ° ë¬¸ì œê°€ ë°œìƒí–ˆì„ê¹Œ?
  ê¸¸ì´ì™€ ë¬´ê²Œì˜ ê¸°ì¤€ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì´ë‹¤. ê¸¸ì´ì˜ ë²”ìœ„ëŠ” (10~40)ì •ë„ì´ê³  ë¬´ê²ŒëŠ”
  (5~1000)ì •ë„ì´ë‹¤. ê²°êµ­ x, yì¶•ì˜ **ìŠ¤ì¼€ì¼ì´ ë‹¬ë¼ì„œ** ë°œìƒí•œ ë¬¸ì œì´ë‹¤.

### 3ï¸âƒ£ ë°ì´í„° ì „ì²˜ë¦¬í•˜ê¸°(feat. í‘œì¤€ ì ìˆ˜)

k-ìµœê·¼ì ‘ ì´ì›ƒ ì•Œê³ ë¦¬ì¦˜ ê°™ì€ ê²½ìš°ëŠ” ìƒ˜í”Œ ê°„ì˜ ê±°ë¦¬ì— ë§ì€ ì˜í–¥ì„ ë°›ìœ¼ë¯€ë¡œ íŠ¹ì„±ê°’ì„ ì¼ì •í•œ ê¸°ì¤€ìœ¼ë¡œ ë§ì¶° ì£¼ì–´ì•¼ í•œë‹¤. ì´ë¥¼ ìœ„í•œ ì‘ì—…ì„ **ë°ì´í„° ì „ì²˜ë¦¬** ë¼ê³  í•œë‹¤. í‘œì¤€ ì ìˆ˜ëŠ” ë°ì´í„° ì „ì²˜ë¦¬ ë°©ë²• ì¤‘ í•˜ë‚˜ë¡œ, ê° íŠ¹ì„±ê°’ì´ í‰ê· ì—ì„œ í‘œì¤€í¸ì°¨ì˜ ëª‡ ë°°ë§Œí¼ ë–¨ì–´ì ¸ìˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. (_(íŠ¹ì„±ê°’ - í‰ê· ) / í‘œì¤€í¸ì°¨_)

```python
mean = np.mean(train_input, axis=0)
std = np.std(train_input, axis=0)
train_scaled = (train_input - mean) / std
new_sample = ([25, 150] - mean / std)
kn.fit(train_scaled, train_target)
```

- ë¸Œë¡œë“œìºìŠ¤íŒ… : ë„˜íŒŒì´ ë°°ì—´ë“¤ë¼ë¦¬ ì—°ì‚° ì‰½ê²Œ í•˜ëŠ” ë„˜íŒŒì´ ê¸°ëŠ¥

### ğŸŒ— í…ŒìŠ¤íŠ¸í•˜ê¸°

```python
test_scaled = (test_input - mean) / std
print(kn.score(test_scaled, test_target))
print(kn.predict([new_sample]))
```

- ìƒê°í•´ë³´ë‹ˆê¹Œ scoreì´ë¼ëŠ” í•¨ìˆ˜ëŠ” ì• ì´ˆì— ë‚´ê°€ ë§Œë“ ê²Œ ì–¼ë§ˆë‚˜ ì •í™•í•œì§€ë¥¼ ë³´ì—¬ì£¼ê¸° ìœ„í•¨ì´ê³ , predict í•¨ìˆ˜ëŠ” ì˜ˆì¸¡í•œ ê²°ê³¼ë¥¼ ì¶œë ¥í•´ì£¼ëŠ” í•¨ìˆ˜ì¸ ê²ƒì´ë‹¤.
